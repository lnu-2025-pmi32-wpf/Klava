<UserControl x:Class="Klava.WPF.Views.TeamListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Klava.WPF.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
            <TextBlock Text="My Teams" 
                       FontSize="28" 
                       FontWeight="Bold"
                       VerticalAlignment="Center"/>
            <Button Content="Logout" 
                    Command="{Binding LogoutCommand}"
                    Margin="Auto,0,0,0"
                    Padding="15,8"
                    Background="#f44336"
                    Foreground="White"
                    BorderThickness="0"
                    Cursor="Hand"/>
        </StackPanel>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
            <Button Content="Create New Team" 
                    Command="{Binding CreateTeamCommand}"
                    Padding="15,10"
                    Background="#2196F3"
                    Foreground="White"
                    BorderThickness="0"
                    Margin="0,0,10,0"
                    Cursor="Hand"/>
            <Button Content="Join Team by Code" 
                    Command="{Binding OpenJoinDialogCommand}"
                    Padding="15,10"
                    Background="#4CAF50"
                    Foreground="White"
                    BorderThickness="0"
                    Cursor="Hand"/>
        </StackPanel>

        <!-- Teams List -->
        <Border Grid.Row="2" 
                BorderBrush="#e0e0e0" 
                BorderThickness="1"
                CornerRadius="4"
                Background="White">
            <Grid>
                <!-- Loading Indicator -->
                <TextBlock Text="Loading teams..." 
                           FontSize="16"
                           Foreground="#666"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <!-- Teams ListView -->
                <ListView ItemsSource="{Binding Teams}"
                          BorderThickness="0">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Team Name" Width="300">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}" 
                                                   FontWeight="Bold"
                                                   FontSize="14"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Team Code" Width="150">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Code}" 
                                                   FontFamily="Consolas"
                                                   FontSize="14"
                                                   Foreground="#2196F3"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Actions" Width="150">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="View Dashboard" 
                                                Command="{Binding DataContext.ViewTeamCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                                CommandParameter="{Binding}"
                                                Padding="10,5"
                                                Background="#2196F3"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Cursor="Hand"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </Border>

        <!-- Join Team Dialog Overlay -->
        <Border Grid.RowSpan="3" 
                Background="#80000000"
                Visibility="{Binding ShowJoinDialog, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border MaxWidth="400" 
                    MaxHeight="250"
                    Background="White"
                    CornerRadius="8"
                    Padding="30"
                    VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" 
                                      ShadowDepth="0" 
                                      Opacity="0.3" 
                                      Color="Black"/>
                </Border.Effect>
                
                <StackPanel>
                    <TextBlock Text="Join Team" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Margin="0,0,0,20"/>

                    <TextBlock Text="Enter 8-character team code:" 
                               Margin="0,0,0,10"/>
                    <TextBox Text="{Binding JoinCode, UpdateSourceTrigger=PropertyChanged}" 
                             Padding="10"
                             FontSize="16"
                             FontFamily="Consolas"
                             MaxLength="8"
                             CharacterCasing="Upper"
                             Margin="0,0,0,20"/>

                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Right">
                        <Button Content="Cancel" 
                                Command="{Binding CloseJoinDialogCommand}"
                                Padding="20,10"
                                Background="#cccccc"
                                Foreground="#333"
                                BorderThickness="0"
                                Margin="0,0,10,0"
                                Cursor="Hand"/>
                        <Button Content="Join" 
                                Command="{Binding JoinTeamCommand}"
                                Padding="20,10"
                                Background="#4CAF50"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</UserControl>
